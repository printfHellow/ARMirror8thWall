(()=>{"use strict";var e={91(e,t,n){n.d(t,{A:()=>s});var o=n(645),a=n.n(o),r=n(278),l=n.n(r)()(a());l.push([e.id,"/* Style for \"Tap To Place Model\" text overlay */\n.over {\n  z-index: 10;\n  pointer-events: none;\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  text-align: center;\n  color: white;\n  font-family: 'Nunito', monospace;\n  text-shadow: 0px 0px 5px black;\n}\n\n#promptText {\n  font-size: 2em;\n  bottom: 12vh;\n  position: absolute;\n  left: 50%;\n  transform: translate(-50%, 0);\n}\n\n/* Control Buttons (Delete & Lock) */\n#controlButtons {\n  position: fixed;\n  top: 20px;\n  right: 20px;\n  z-index: 25;\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n  pointer-events: auto;\n}\n\n.control-btn {\n  width: 60px;\n  height: 60px;\n  border: 3px solid rgba(255, 255, 255, 0.5);\n  border-radius: 50%;\n  background: rgba(0, 0, 0, 0.6);\n  backdrop-filter: blur(10px);\n  cursor: pointer;\n  transition: all 0.3s ease;\n  font-size: 28px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);\n}\n\n.control-btn:hover:not(.disabled) {\n  transform: scale(1.1);\n  border-color: rgba(255, 255, 255, 0.8);\n  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.4);\n}\n\n.control-btn:active:not(.disabled) {\n  transform: scale(0.95);\n}\n\n.delete-btn {\n  border-color: rgba(255, 59, 48, 0.7);\n}\n\n.delete-btn:hover:not(.disabled) {\n  border-color: #ff3b30;\n  background: rgba(255, 59, 48, 0.2);\n  box-shadow: 0 0 20px rgba(255, 59, 48, 0.4);\n}\n\n.lock-btn {\n  border-color: rgba(90, 200, 250, 0.7);\n}\n\n.lock-btn:hover:not(.disabled) {\n  border-color: #5ac8fa;\n  background: rgba(90, 200, 250, 0.2);\n  box-shadow: 0 0 20px rgba(90, 200, 250, 0.4);\n}\n\n.control-btn.disabled {\n  opacity: 0.3;\n  cursor: not-allowed;\n}\n\n/* Model selector UI */\n#modelSelector {\n  position: fixed;\n  bottom: 20px;\n  left: 50%;\n  transform: translateX(-50%);\n  z-index: 20;\n  pointer-events: auto;\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  background: rgba(0, 0, 0, 0.5);\n  padding: 15px;\n  border-radius: 15px;\n  backdrop-filter: blur(10px);\n}\n\n#modelGrid {\n  display: flex;\n  gap: 10px;\n}\n\n.model-button {\n  width: 70px;\n  height: 70px;\n  border: 3px solid rgba(255, 255, 255, 0.5);\n  border-radius: 12px;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  position: relative;\n  background-color: rgba(255, 255, 255, 0.1);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 11px;\n  font-weight: bold;\n  color: white;\n  text-shadow: 0px 0px 4px black;\n  text-align: center;\n  padding: 5px;\n  overflow: hidden;\n}\n\n.model-button:hover {\n  transform: scale(1.1);\n  border-color: rgba(255, 255, 255, 0.8);\n}\n\n.model-button.selected {\n  border-color: #5ac8fa;\n  border-width: 4px;\n  box-shadow: 0 0 20px rgba(90, 200, 250, 0.6);\n}\n\n.model-button::after {\n  content: '';\n  position: absolute;\n  bottom: -8px;\n  left: 50%;\n  transform: translateX(-50%);\n  width: 0;\n  height: 0;\n  border-left: 6px solid transparent;\n  border-right: 6px solid transparent;\n  border-bottom: 6px solid #5ac8fa;\n  opacity: 0;\n  transition: opacity 0.3s ease;\n}\n\n.model-button.selected::after {\n  opacity: 1;\n}\n\n.nav-button {\n  width: 40px;\n  height: 40px;\n  border: 2px solid rgba(255, 255, 255, 0.5);\n  border-radius: 50%;\n  background: rgba(255, 255, 255, 0.2);\n  color: white;\n  font-size: 20px;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  user-select: none;\n}\n\n.nav-button:hover:not(.disabled) {\n  background: rgba(255, 255, 255, 0.4);\n  transform: scale(1.1);\n}\n\n.nav-button.disabled {\n  opacity: 0.3;\n  cursor: not-allowed;\n}\n\n#pageIndicator {\n  color: white;\n  font-size: 12px;\n  min-width: 40px;\n  text-align: center;\n}\n",""]);const s=l},278(e){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n="",o=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),o&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),o&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n}).join("")},t.i=function(e,n,o,a,r){"string"==typeof e&&(e=[[null,e,void 0]]);var l={};if(o)for(var s=0;s<this.length;s++){var i=this[s][0];null!=i&&(l[i]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);o&&l[d[0]]||(void 0!==r&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=r),n&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=n):d[2]=n),a&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=a):d[4]="".concat(a)),t.push(d))}},t}},645(e){e.exports=function(e){return e[1]}},292(e){var t=[];function n(e){for(var n=-1,o=0;o<t.length;o++)if(t[o].identifier===e){n=o;break}return n}function o(e,o){for(var r={},l=[],s=0;s<e.length;s++){var i=e[s],c=o.base?i[0]+o.base:i[0],d=r[c]||0,u="".concat(c," ").concat(d);r[c]=d+1;var p=n(u),h={css:i[1],media:i[2],sourceMap:i[3],supports:i[4],layer:i[5]};if(-1!==p)t[p].references++,t[p].updater(h);else{var m=a(h,o);o.byIndex=s,t.splice(s,0,{identifier:u,updater:m,references:1})}l.push(u)}return l}function a(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,a){var r=o(e=e||[],a=a||{});return function(e){e=e||[];for(var l=0;l<r.length;l++){var s=n(r[l]);t[s].references--}for(var i=o(e,a),c=0;c<r.length;c++){var d=n(r[c]);0===t[d].references&&(t[d].updater(),t.splice(d,1))}r=i}}},383(e){var t={};e.exports=function(e,n){var o=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(n)}},88(e){e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},884(e,t,n){e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},893(e){e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var o="";n.supports&&(o+="@supports (".concat(n.supports,") {")),n.media&&(o+="@media ".concat(n.media," {"));var a=void 0!==n.layer;a&&(o+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),o+=n.css,a&&(o+="}"),n.media&&(o+="}"),n.supports&&(o+="}");var r=n.sourceMap;r&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),t.styleTagTransform(o,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},997(e){e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function n(o){var a=t[o];if(void 0!==a)return a.exports;var r=t[o]={id:o,exports:{}};return e[o](r,r.exports,n),r.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0;var o=n(292),a=n.n(o),r=n(893),l=n.n(r),s=n(383),i=n.n(s),c=n(884),d=n.n(c),u=n(88),p=n.n(u),h=n(997),m=n.n(h),f=n(91),g={};g.styleTagTransform=m(),g.setAttributes=d(),g.insert=i().bind(null,"head"),g.domAPI=l(),g.insertStyleElement=p(),a()(f.A,g),f.A&&f.A.locals&&f.A.locals;var b={schema:{min:{default:6},max:{default:10}},init:function(){var e=this;this.prompt=document.getElementById("promptText"),this.models=[],this.selectedModel=null,this.selectedModelId="model1",this.modelTypes=[{id:"model1",name:"Model 1",scale:5},{id:"model2",name:"Model 2",scale:5},{id:"model3",name:"Model 3",scale:10},{id:"model4",name:"Model 4",scale:5},{id:"model5",name:"Model 5",scale:5},{id:"model6",name:"Model 6",scale:5},{id:"model7",name:"Model 7",scale:6}],this.modelsPerPage=2,this.currentPage=0,this.totalPages=Math.ceil(this.modelTypes.length/this.modelsPerPage),this.touchStartDistance=0,this.initialScale=1,this.isDragging=!1,this.dragStartPoint=null,this.isClickingModel=!1,this.setupModelSelector(),this.setupControlButtons(),this.setupRaycaster(),this.el.sceneEl.addEventListener("click",function(t){e.handleSceneClick(t)}),this.setupTouchHandlers()},setupRaycaster:function(){var e=document.getElementById("camera");e&&e.setAttribute("raycaster",{objects:".cantap, .placed-model, [xr-planes]",far:100,near:0})},handleSceneClick:function(e){if(this.models.length>0)console.log("Model Ä‘Ã£ tá»“n táº¡i, hÃ£y xÃ³a trÆ°á»›c khi Ä‘áº·t má»›i.");else if(!this.isDragging)if(e.detail&&e.detail.intersection){var t=e.detail.intersection,n=t.object;if(!(n&&n.el&&n.el.classList.contains("placed-model"))){var o=t.point,a=t.face?t.face.normal.clone():new THREE.Vector3(0,1,0);n&&n.matrixWorld&&a.transformDirection(n.matrixWorld),this.prompt.style.display="none";var r=Math.abs(a.y)<.5;Math.abs(a.y),console.log("Surface type:",r?"Wall":"Ground/Ceiling"),console.log("Normal vector:",a),console.log("Touch point:",o),this.placeModel(o,a,r)}}else console.log("No intersection detected")},placeModel:function(e,t,n){var o=this,a=document.createElement("a-entity");a.setAttribute("position",e);var r,l=this.modelTypes.find(function(e){return e.id===o.selectedModelId}),s=l?l.scale:1;if(n){var i=Math.atan2(t.x,t.z)*(180/Math.PI);r="0 ".concat(i+180," 0");var c=t.clone().multiplyScalar(.1);e.add(c),a.setAttribute("position",e)}else{var d=document.getElementById("camera").object3D.position,u=new THREE.Vector3;u.subVectors(d,e),u.y=0,u.normalize();var p=Math.atan2(u.x,u.z)*(180/Math.PI);r="0 ".concat(p," 0")}a.setAttribute("rotation",r),a.setAttribute("visible","false"),a.setAttribute("scale","0.0001 0.0001 0.0001"),a.setAttribute("gltf-model","#".concat(this.selectedModelId)),a.classList.add("placed-model"),a.classList.add("cantap"),a.userData={baseScale:s,currentScale:s,isLocked:!1,surfaceNormal:t.clone(),isOnWall:n},this.el.sceneEl.appendChild(a),this.models.push(a),a.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault(),o.selectModel(a)}),a.addEventListener("model-loaded",function(){a.setAttribute("visible","true"),a.setAttribute("animation",{property:"scale",to:"".concat(s," ").concat(s," ").concat(s),easing:"easeOutElastic",dur:800})}),setTimeout(function(){return o.selectModel(a)},100)},setupModelSelector:function(){var e=this,t=document.getElementById("modelGrid"),n=document.getElementById("prevPage"),o=document.getElementById("nextPage"),a=document.getElementById("pageIndicator"),r=function(){t.innerHTML="";var r=e.currentPage*e.modelsPerPage,l=Math.min(r+e.modelsPerPage,e.modelTypes.length);e.modelTypes.slice(r,l).forEach(function(n){var o=document.createElement("div");o.className="model-button",n.id===e.selectedModelId&&o.classList.add("selected"),o.setAttribute("data-model",n.id),o.textContent=n.name,o.addEventListener("click",function(){document.querySelectorAll(".model-button").forEach(function(e){e.classList.remove("selected")}),o.classList.add("selected"),e.selectedModelId=n.id}),t.appendChild(o)}),a.textContent="".concat(e.currentPage+1,"/").concat(e.totalPages),n.classList.toggle("disabled",0===e.currentPage),o.classList.toggle("disabled",e.currentPage===e.totalPages-1)};n.addEventListener("click",function(){e.currentPage>0&&(e.currentPage--,r())}),o.addEventListener("click",function(){e.currentPage<e.totalPages-1&&(e.currentPage++,r())}),r()},setupControlButtons:function(){var e=this,t=document.getElementById("deleteBtn"),n=document.getElementById("lockBtn");t.addEventListener("click",function(){e.selectedModel&&e.deleteSelectedModel()}),n.addEventListener("click",function(){e.selectedModel&&e.toggleLock()}),this.updateControlButtons()},selectModel:function(e){this.selectedModel&&this.selectedModel.setAttribute("animation__deselect",{property:"scale",to:"".concat(this.selectedModel.userData.currentScale," ").concat(this.selectedModel.userData.currentScale," ").concat(this.selectedModel.userData.currentScale),dur:200,easing:"easeOutQuad"}),this.selectedModel=e;var t=e.userData.currentScale;e.setAttribute("animation__select",{property:"scale",to:"".concat(1.1*t," ").concat(1.1*t," ").concat(1.1*t),dur:200,easing:"easeOutQuad"}),this.updateControlButtons()},deleteSelectedModel:function(){if(this.selectedModel){var e=this.models.indexOf(this.selectedModel);e>-1&&this.models.splice(e,1),this.selectedModel.remove(),this.selectedModel=null,this.updateControlButtons()}},toggleLock:function(){this.selectedModel&&(this.selectedModel.userData.isLocked=!this.selectedModel.userData.isLocked,this.updateControlButtons())},updateControlButtons:function(){var e=document.getElementById("deleteBtn"),t=document.getElementById("lockBtn"),n=document.getElementById("controlButtons");this.selectedModel?(n.style.display="flex",e.classList.remove("disabled"),t.classList.remove("disabled"),t.textContent=this.selectedModel.userData.isLocked?"ðŸ”’":"ðŸ”“"):n.style.display="none"},setupTouchHandlers:function(){var e=this,t=this.el.sceneEl;t.addEventListener("touchstart",function(t){if(e.selectedModel&&!e.selectedModel.userData.isLocked)if(2===t.touches.length){var n=t.touches[0],o=t.touches[1];e.touchStartDistance=Math.hypot(o.clientX-n.clientX,o.clientY-n.clientY),e.initialScale=e.selectedModel.userData.currentScale}else 1===t.touches.length&&(e.isDragging=!0,e.dragStartPoint={x:t.touches[0].clientX,y:t.touches[0].clientY})}),t.addEventListener("touchmove",function(t){if(e.selectedModel&&!e.selectedModel.userData.isLocked)if(2===t.touches.length){t.preventDefault();var n=t.touches[0],o=t.touches[1],a=Math.hypot(o.clientX-n.clientX,o.clientY-n.clientY)/e.touchStartDistance,r=e.initialScale*a,l=e.selectedModel.userData.baseScale,s=Math.max(.001*l,r);e.selectedModel.userData.currentScale=s,e.selectedModel.setAttribute("scale","".concat(s," ").concat(s," ").concat(s))}else if(1===t.touches.length&&e.isDragging){t.preventDefault();var i=document.getElementById("camera"),c=t.touches[0],d=.01*(c.clientX-e.dragStartPoint.x),u=.01*(c.clientY-e.dragStartPoint.y),p=new THREE.Vector3;i.object3D.getWorldDirection(p),p.y=0,p.normalize();var h=new THREE.Vector3;h.crossVectors(new THREE.Vector3(0,1,0),p);var m=e.selectedModel.object3D.position.clone(),f=new THREE.Vector3;f.addScaledVector(h,d),f.addScaledVector(p,u),m.add(f),e.selectedModel.setAttribute("position",m),e.dragStartPoint={x:c.clientX,y:c.clientY}}}),t.addEventListener("touchend",function(t){t.touches.length<2&&(e.touchStartDistance=0),0===t.touches.length&&(e.isDragging=!1,e.dragStartPoint=null)})}};AFRAME.registerComponent("tap-place",b)})();